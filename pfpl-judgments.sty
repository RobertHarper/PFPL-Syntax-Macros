\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{pfpl-judgments}[2023/05/01 1.0.0 PFPL Judgment Forms]
\RequirePackage{stackengine,scalerel,amsmath,mathtools}

\makeatletter

\stackMath
\def\cc@dot{\scalebox{1.15}{$\SavedStyle\cdot$}}
\def\generic@form#1#2{\stackunder[#1]{\stackon[#2]{\SavedStyle\sim}{\cc@dot}}{\cc@dot}}
\def\alt@div{\mathrel{\ThisStyle{\mathchoice%
  {\generic@form{-2.5pt}{-1.5pt}}%
  {\generic@form{-2.5pt}{-1.5pt}}%
  {\generic@form{-2.0pt}{-1.1pt}}%
  {\generic@form{-1.4pt}{-0.8pt}}%
}}}

% statics

\NewDocumentCommand{\isTp}{m}{#1\,\textsf{type}}
\NewDocumentCommand{\isKd}{m}{#1\,\textsf{kind}}
\NewDocumentCommand{\isOfKd}{s m m}{#2\IfBooleanTF{#1}{\mathbin}{\mathrel}{{:}{:}} #3}

\NewDocumentCommand{\isOf}{s m m}{#2\IfBooleanTF{#1}{\mathbin}{\mathrel}{:} #3}
\NewDocumentCommand{\ofTp}{s m m}{\IfBooleanTF{#1}{\isOf*{#2}{#3}}{\isOf{#2}{#3}}}

\NewDocumentCommand{\retsTp}{m m}{#1\alt@div #2}
\NewDocumentCommand{\hasTp}{s m m}{#2\IfBooleanTF{#1}{\mathbin}{\mathrel}{\sim} #3}

\NewDocumentCommand{\okSt}{m}{#1\,\textsf{ok}}

% equality

\NewDocumentCommand{\eqTp}{m m}{#1\mathrel{\eqdot}#2\,\textsf{type}}
\NewDocumentCommand{\eqOfKd}{m m m}{#1\mathrel{\eqdot}#2\mathrel{{:}{:}}#3}

\NewDocumentCommand{\eqOf}{m m m}{#1\mathrel{\eqdot}#2\mathrel{:}#3}
\NewDocumentCommand{\eqOfTp}{m m m}{\eqOf{#1}{#2}{#3}}

% dynamics

\NewDocumentCommand{\isVal}{o m}{#2\,\textsf{val}\IfValueT{#1}{_{#1}}}

\NewDocumentCommand{\isIni}{O{} m}{#2\,\textsf{ini}_{#1}}
\NewDocumentCommand{\isFin}{O{} m}{#2\,\textsf{fin}_{#1}}

\NewDocumentCommand{\stepsTo}{O{\hspace{.5pc}} D<>{\hspace{.5pc}} D(){}}{\mathrel{\xmapsto[\hspace{.25pc}#1\hspace{.25pc}]{\hspace{.25pc}#2\hspace{.25pc}}}^{#3}}

\NewDocumentCommand{\evalsTo}{O{} D(){}}{\mathrel{\Downarrow}_{#1}^{#2}}
\NewDocumentCommand{\raises}{O{} D(){}}{\mathrel{\Uparrow}_{#1}^{#2}}
\NewDocumentCommand{\evalsorraises}{O{} D(){}}{\mathrel{\Updownarrow}_{#1}^{#2}}

% entailment

\NewDocumentCommand{\entails}{O{}}{\mathrel{\vdash}_{#1}}

\makeatother
